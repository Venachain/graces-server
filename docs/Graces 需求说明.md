# Graces 需求说明

|    时间    | 修改人 | 修改事项 | 版本  |
| :--------: | :----: | :------: | :---: |
| 2021.09.15 |  杨毅  |   整理   | 0.0.2 |
| 2021.07.26 |  杨毅  |   初稿   | 0.0.1 |

[TOC]

## 需求概要

Graces 作为面向开发者的 Venachain 区块链浏览器，需要支持以下主要功能：

- 链数据浏览功能
  - 区块数据浏览
  - 交易数据浏览
  - 合约数据浏览
  - CNS 数据浏览
  - 节点监控

- 链操作功能

  - 链系统参数设置
  - 链节点操作
  - 管理已在运行的 Venachain 链
  - 部署新的 Venachain 链

- 其他功能

  - 多链管理

    支持管理多条 Venachain 链。

## 区块数据浏览

可以查看到当前链上已经上链的所有区块信息，还可以查看每一个区块的详细信息，包括但不限于以下区块数据内容：

- 区块的高度
- 区块的哈希
- 上一个区块的哈希
- 出块的时间
- 本区块的交易总数
- 区块内所有交易的 Gas 限制
- 区块内所有交易的 Gas 消耗
- 区块大小

## 交易数据浏览

可以查看到当前链上已经上链的所有交易信息，还可以查看每一笔交易的详细信息，包括但不限于以下交易数据内容：

- 交易哈希
- 该交易所在的区块的高度
- 交易发起的时间
- 交易发起人地址
- 交易目标地址
- Gas 限制
- Gas 价格
- 交易 Nonce
- 交易金额
- 该交易是否是合约调用
- 如果该交易是合约调用，则需要显示合约数据
- 交易状态

## 合约数据浏览

可以查看到当前链上已经上链的所有合约信息，还可以查看每一个合约的详细信息，包括但不限于以下合约数据内容：

- 合约地址
- 合约关联的 CNS 数据
- 合约创建人地址
- 部署该合约时发生的交易的哈希
- 合约的代码内容
- 合约的部署时间

## CNS 数据浏览

可以查看到当前链上 CNS 管理器所管理的所有 CNS 信息，还可以查看每一个 CNS 的详细信息，包括但不限于以下 CNS 数据内容：

- CNS 名称
- CNS 合约地址
- CNS 版本号

## 链系统参数设置

可以设置一些链上的参数，以达到对链的灵活管控，可以设置的参数如下：

- setBlockGasLimit

  设置区块的 Gas 限制。

- setTxGasLimit

  设置交易的 Gas 限制。

- setIsApproveDeployedContract

  设置是否允许在链上部署合约。

- setCheckContractDeployPermission

  设置是否检查合约部署权限。

- setIsProduceEmptyBlock

  设置是否可以产生空块。

- setGasContractName

  指定一个合约名称，使得后续的所有交易所需要的 Gas 都由这个合约来提供。

  如果设置了设置这个合约名称，则发生交易时产生的 Gas 消耗会去调用 CNS 查找此名称所对应的合约地址的合约来提供 Gas，假如指定的合约名称对应的合约没有 Gas 或不够，则报错。

- setIsTxUseGas【待确认】

  设置交易执行时是否使用指定的合约来提供 Gas，这里需要配合 setGasContractName 一起才有效果。

## 链节点监控

可以查看到当前链上所有的 P2P 节点信息，还可以查看每一个节点的详细信息，包括但不限于以下节点数据内容：

- 节点名称（节点编号）
- 节点 IP 地址
- 节点 P2P 端口号
- 节点 RPC 端口号
- 节点类型（共识/非共识）
- 节点状态（是否在线）

## 链节点操作

可以对链的节点进行以下操作：

- 为链添加新的节点
- 启动链已有的处于关闭状态的节点
- 关闭链已有的处于运行状态的节点
- 重启链已有的处于运行状态的节点

## 管理已在运行的 Venachain 链

可以把已经在运行的 Venachain 链添加到 Graces 进行管理。

## 部署新的 Venachain 链

可以直接在 Graces 上为指定服务器部署一条新的 Venachain 链。

## 多链管理

支持管理多条 Venachain 链，包括已在运行的链和从 Graces 部署的新链。